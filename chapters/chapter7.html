<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第7章：函数 - Python交互式教程</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="../index.html">🐍 Python交互式教程</a>
            <div class="navbar-nav ms-auto">
                <span class="nav-link text-light">
                    <span id="python-status">⏳ Python环境加载中...</span>
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-3">
                <!-- 目录侧边栏 -->
                <div class="sticky-top" style="top: 1rem;">
                    <div class="card">
                        <div class="card-header">
                            <h6>📚 课程目录</h6>
                        </div>
                        <div class="card-body p-2">
                            <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="chapter1.html">第1章：Python基础</a>
                                <a class="nav-link" href="chapter2.html">第2章：变量与数据类型</a>
                                <a class="nav-link" href="chapter3.html">第3章：运算符与表达式</a>
                                <a class="nav-link" href="chapter4.html">第4章：控制结构</a>
                                <a class="nav-link" href="chapter5.html">第5章：列表与元组</a>
                                <a class="nav-link" href="chapter6.html">第6章：字典与集合</a>
                                <a class="nav-link active" href="chapter7.html">第7章：函数</a>
                                <a class="nav-link" href="chapter8.html">第8章：模块与包</a>
                                <a class="nav-link" href="chapter9.html">第9章：字符串处理</a>
                                <a class="nav-link" href="chapter10.html">第10章：正则表达式</a>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 主内容区 -->
            <div class="col-md-9">
                <div class="chapter-content">
                    <h1>第7章：函数</h1>

                    <!-- 学习目标 -->
                    <section class="mb-4">
                        <div class="card bg-light">
                            <div class="card-header">
                                <h5>🎯 学习目标</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>理解函数的概念和作用</li>
                                    <li>掌握函数的定义和调用</li>
                                    <li>学会使用参数和返回值</li>
                                    <li>理解作用域的概念</li>
                                    <li>掌握lambda函数的使用</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- 知识点1：函数基础 -->
                    <section class="mb-4">
                        <h2>📚 函数基础</h2>
                        <p>函数是一段可重复使用的代码块，用来完成特定的任务。函数可以接收参数，执行操作，并返回结果。</p>

                        <h3>定义和调用函数</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 定义函数</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 定义一个简单的函数
def greet():
    print("你好！欢迎学习Python！")

# 调用函数
greet()

# 定义带参数的函数
def greet_person(name):
    print(f"你好，{name}！")

# 调用带参数的函数
greet_person("张三")
greet_person("李四")

# 定义有返回值的函数
def add_numbers(a, b):
    result = a + b
    return result

# 调用并获取返回值
sum_result = add_numbers(5, 3)
print(f"5 + 3 = {sum_result}")</code></pre>
                        </div>
                    </section>

                    <!-- 知识点2：参数类型 -->
                    <section class="mb-4">
                        <h2>🔧 参数类型</h2>
                        
                        <h3>位置参数和关键字参数</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 参数类型</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 位置参数
def introduce(name, age, city):
    print(f"我叫{name}，今年{age}岁，来自{city}")

# 按位置传递参数
introduce("张三", 25, "北京")

# 关键字参数
introduce(age=30, name="李四", city="上海")

# 混合使用（位置参数必须在前）
introduce("王五", age=28, city="广州")</code></pre>
                        </div>

                        <h3>默认参数</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 默认参数</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 定义带默认参数的函数
def greet_with_title(name, title="同学"):
    print(f"你好，{title}{name}！")

# 使用默认参数
greet_with_title("张三")

# 覆盖默认参数
greet_with_title("张三", "老师")

# 计算圆的面积（带默认的π值）
def circle_area(radius, pi=3.14159):
    return pi * radius ** 2

print(f"半径为5的圆面积: {circle_area(5)}")
print(f"使用精确π值: {circle_area(5, 3.141592653589793)}")</code></pre>
                        </div>

                        <h3>可变参数</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 可变参数</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># *args - 可变位置参数
def sum_all(*numbers):
    total = 0
    for num in numbers:
        total += num
    return total

print("求和:", sum_all(1, 2, 3, 4, 5))
print("求和:", sum_all(10, 20))

# **kwargs - 可变关键字参数
def print_info(**info):
    for key, value in info.items():
        print(f"{key}: {value}")

print("学生信息:")
print_info(name="张三", age=20, major="计算机科学", city="北京")

# 混合使用
def full_info(name, *hobbies, **details):
    print(f"姓名: {name}")
    print(f"爱好: {', '.join(hobbies)}")
    for key, value in details.items():
        print(f"{key}: {value}")

print("\n完整信息:")
full_info("李四", "读书", "游泳", "编程", age=25, city="上海")</code></pre>
                        </div>
                    </section>

                    <!-- 知识点3：作用域 -->
                    <section class="mb-4">
                        <h2>🌐 作用域</h2>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 变量作用域</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 全局变量
global_var = "我是全局变量"

def scope_demo():
    # 局部变量
    local_var = "我是局部变量"
    print("函数内部:")
    print("  全局变量:", global_var)
    print("  局部变量:", local_var)

scope_demo()

print("函数外部:")
print("  全局变量:", global_var)
# print("  局部变量:", local_var)  # 这行会报错，因为局部变量在函数外不可访问

# global关键字
counter = 0

def increment():
    global counter
    counter += 1
    print(f"计数器: {counter}")

increment()
increment()
print(f"最终计数器值: {counter}")

# nonlocal关键字
def outer_function():
    x = 10
    
    def inner_function():
        nonlocal x
        x += 5
        print(f"内部函数中的x: {x}")
    
    inner_function()
    print(f"外部函数中的x: {x}")

outer_function()</code></pre>
                        </div>
                    </section>

                    <!-- 知识点4：Lambda函数 -->
                    <section class="mb-4">
                        <h2>⚡ Lambda函数</h2>
                        <p>Lambda函数是匿名函数，用于创建简短的函数。语法：lambda 参数: 表达式</p>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 Lambda函数</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 基本lambda函数
square = lambda x: x ** 2
print(f"5的平方: {square(5)}")

# 多个参数的lambda
add = lambda x, y: x + y
print(f"3 + 7 = {add(3, 7)}")

# 在内置函数中使用lambda
numbers = [1, 2, 3, 4, 5]

# map() - 对每个元素应用函数
squares = list(map(lambda x: x**2, numbers))
print("平方数:", squares)

# filter() - 过滤元素
evens = list(filter(lambda x: x % 2 == 0, numbers))
print("偶数:", evens)

# sorted() - 排序
students = [("张三", 85), ("李四", 92), ("王五", 78)]
sorted_by_score = sorted(students, key=lambda student: student[1])
print("按成绩排序:", sorted_by_score)

# 复杂的lambda示例
data = [
    {"name": "张三", "age": 25, "score": 85},
    {"name": "李四", "age": 23, "score": 92},
    {"name": "王五", "age": 27, "score": 78}
]

# 按年龄排序
sorted_by_age = sorted(data, key=lambda x: x["age"])
print("按年龄排序:")
for item in sorted_by_age:
    print(f"  {item['name']}: {item['age']}岁")</code></pre>
                        </div>
                    </section>

                    <!-- 知识点5：装饰器基础 -->
                    <section class="mb-4">
                        <h2>🎭 装饰器基础</h2>
                        <p>装饰器是一种设计模式，用于在不修改原函数代码的情况下，为函数添加新功能。</p>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 简单装饰器</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">import time

# 定义一个计时装饰器
def timer(func):
    def wrapper(*args, **kwargs):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        print(f"{func.__name__} 执行时间: {end_time - start_time:.4f}秒")
        return result
    return wrapper

# 使用装饰器
@timer
def slow_function():
    time.sleep(0.1)  # 模拟耗时操作
    return "任务完成"

# 调用被装饰的函数
result = slow_function()
print(result)

# 日志装饰器
def log_calls(func):
    def wrapper(*args, **kwargs):
        print(f"调用函数: {func.__name__}")
        print(f"参数: args={args}, kwargs={kwargs}")
        result = func(*args, **kwargs)
        print(f"返回值: {result}")
        return result
    return wrapper

@log_calls
def multiply(x, y):
    return x * y

multiply(3, 4)</code></pre>
                        </div>
                    </section>

                    <!-- 实践练习 -->
                    <section class="mb-4">
                        <h2>💻 实践练习</h2>
                        
                        <h3>练习1：计算器函数</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 计算器函数</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 定义计算器函数
def calculator(a, b, operation="+"):
    """
    简单计算器函数
    参数:
        a: 第一个数字
        b: 第二个数字
        operation: 运算符 (+, -, *, /, **)
    返回:
        计算结果
    """
    if operation == "+":
        return a + b
    elif operation == "-":
        return a - b
    elif operation == "*":
        return a * b
    elif operation == "/":
        if b != 0:
            return a / b
        else:
            return "错误：除数不能为零"
    elif operation == "**":
        return a ** b
    else:
        return "错误：不支持的运算符"

# 测试计算器
print("计算器测试:")
print(f"10 + 5 = {calculator(10, 5)}")
print(f"10 - 5 = {calculator(10, 5, '-')}")
print(f"10 * 5 = {calculator(10, 5, '*')}")
print(f"10 / 5 = {calculator(10, 5, '/')}")
print(f"10 ** 2 = {calculator(10, 2, '**')}")
print(f"10 / 0 = {calculator(10, 0, '/')}")

# 批量计算
operations = [
    (15, 3, "+"),
    (15, 3, "-"),
    (15, 3, "*"),
    (15, 3, "/")
]

for a, b, op in operations:
    result = calculator(a, b, op)
    print(f"{a} {op} {b} = {result}")</code></pre>
                        </div>

                        <h3>练习2：统计函数</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 统计函数</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 定义统计函数
def statistics(numbers):
    """
    计算数字列表的统计信息
    返回: 字典包含最大值、最小值、平均值、总和
    """
    if not numbers:
        return {"error": "列表为空"}
    
    return {
        "count": len(numbers),
        "sum": sum(numbers),
        "average": sum(numbers) / len(numbers),
        "max": max(numbers),
        "min": min(numbers),
        "range": max(numbers) - min(numbers)
    }

# 高阶函数 - 自定义过滤和映射
def process_data(data, filter_func=None, map_func=None):
    """
    处理数据：过滤和转换
    """
    result = data
    
    if filter_func:
        result = list(filter(filter_func, result))
    
    if map_func:
        result = list(map(map_func, result))
    
    return result

# 测试统计函数
test_data = [85, 92, 78, 96, 88, 76, 94, 82, 90, 87]
stats = statistics(test_data)

print("成绩统计:")
for key, value in stats.items():
    if key == "average":
        print(f"{key}: {value:.2f}")
    else:
        print(f"{key}: {value}")

# 测试数据处理函数
print("\n数据处理测试:")
print("原始数据:", test_data)

# 筛选大于等于85分的成绩
high_scores = process_data(test_data, filter_func=lambda x: x >= 85)
print("高分(>=85):", high_scores)

# 将分数转换为等级
def score_to_grade(score):
    if score >= 90:
        return "A"
    elif score >= 80:
        return "B"
    elif score >= 70:
        return "C"
    else:
        return "D"

grades = process_data(test_data, map_func=score_to_grade)
print("等级转换:", grades)

# 组合操作：筛选高分并转换为等级
high_grades = process_data(
    test_data, 
    filter_func=lambda x: x >= 85,
    map_func=score_to_grade
)
print("高分等级:", high_grades)</code></pre>
                        </div>
                    </section>

                    <!-- 章节总结 -->
                    <section class="mb-4">
                        <div class="card bg-light">
                            <div class="card-header">
                                <h5>📋 本章总结</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>函数是代码的基本组织单元，提高代码重用性</li>
                                    <li>参数类型：位置参数、关键字参数、默认参数、可变参数</li>
                                    <li>理解全局作用域和局部作用域的区别</li>
                                    <li>Lambda函数用于创建简短的匿名函数</li>
                                    <li>装饰器可以为函数添加额外功能</li>
                                    <li>良好的函数设计：功能单一、命名清晰、文档完整</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- 导航按钮 -->
                    <div class="d-flex justify-content-between mb-4">
                        <a href="chapter6.html" class="btn btn-outline-primary">← 上一章：字典与集合</a>
                        <a href="chapter8.html" class="btn btn-primary">下一章：模块与包 →</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 引入必要的JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script src="../assets/js/tutorial-interactive.js"></script>
</body>
</html>
