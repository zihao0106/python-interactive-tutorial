<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第8章：模块与包 - Python交互式教程</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="../index.html">🐍 Python交互式教程</a>
            <div class="navbar-nav ms-auto">
                <span class="nav-link text-light">
                    <span id="python-status">⏳ Python环境加载中...</span>
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-3">
                <!-- 目录侧边栏 -->
                <div class="sticky-top" style="top: 1rem;">
                    <div class="card">
                        <div class="card-header">
                            <h6>📚 课程目录</h6>
                        </div>
                        <div class="card-body p-2">
                            <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="chapter1.html">第1章：Python基础</a>
                                <a class="nav-link" href="chapter2.html">第2章：变量与数据类型</a>
                                <a class="nav-link" href="chapter3.html">第3章：运算符与表达式</a>
                                <a class="nav-link" href="chapter4.html">第4章：控制结构</a>
                                <a class="nav-link" href="chapter5.html">第5章：列表与元组</a>
                                <a class="nav-link" href="chapter6.html">第6章：字典与集合</a>
                                <a class="nav-link" href="chapter7.html">第7章：函数</a>
                                <a class="nav-link active" href="chapter8.html">第8章：模块与包</a>
                                <a class="nav-link" href="chapter9.html">第9章：字符串处理</a>
                                <a class="nav-link" href="chapter10.html">第10章：正则表达式</a>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 主内容区 -->
            <div class="col-md-9">
                <div class="chapter-content">
                    <h1>第8章：模块与包</h1>

                    <!-- 学习目标 -->
                    <section class="mb-4">
                        <div class="card bg-light">
                            <div class="card-header">
                                <h5>🎯 学习目标</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>理解模块和包的概念</li>
                                    <li>掌握模块的导入和使用</li>
                                    <li>学会创建自定义模块</li>
                                    <li>了解常用的标准库模块</li>
                                    <li>学习包的组织和管理</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- 知识点1：模块基础 -->
                    <section class="mb-4">
                        <h2>📚 模块基础</h2>
                        <p>模块是包含Python代码的文件，可以定义函数、类和变量。模块让我们能够组织代码并重用功能。</p>

                        <h3>导入模块</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 导入模块</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 导入整个模块
import math
print(f"π的值: {math.pi}")
print(f"10的平方根: {math.sqrt(10)}")

# 导入特定函数
from math import sin, cos, pi
print(f"sin(π/2): {sin(pi/2)}")
print(f"cos(π): {cos(pi)}")

# 使用别名导入
import datetime as dt
now = dt.datetime.now()
print(f"当前时间: {now.strftime('%Y-%m-%d %H:%M:%S')}")

# 导入所有内容（不推荐）
from random import *
print(f"随机数: {randint(1, 100)}")

# 查看模块的所有属性
import sys
print(f"Python版本: {sys.version}")
print(f"模块搜索路径数量: {len(sys.path)}")</code></pre>
                        </div>
                    </section>

                    <!-- 知识点2：常用标准库模块 -->
                    <section class="mb-4">
                        <h2>🔧 常用标准库模块</h2>
                        
                        <h3>datetime - 日期时间处理</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 datetime模块</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">from datetime import datetime, date, timedelta

# 获取当前日期和时间
now = datetime.now()
today = date.today()

print(f"当前日期时间: {now}")
print(f"今天的日期: {today}")

# 格式化日期时间
formatted_date = now.strftime("%Y年%m月%d日 %H:%M:%S")
print(f"格式化日期: {formatted_date}")

# 日期运算
tomorrow = today + timedelta(days=1)
last_week = today - timedelta(weeks=1)

print(f"明天: {tomorrow}")
print(f"一周前: {last_week}")

# 创建特定日期
birthday = date(2000, 1, 1)
age_days = (today - birthday).days
print(f"从2000年1月1日到今天已经过了 {age_days} 天")

# 解析日期字符串
date_string = "2023-12-25"
parsed_date = datetime.strptime(date_string, "%Y-%m-%d")
print(f"解析的日期: {parsed_date.date()}")</code></pre>
                        </div>

                        <h3>random - 随机数生成</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 random模块</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">import random

# 生成随机数
print(f"0-1之间的随机浮点数: {random.random()}")
print(f"1-100之间的随机整数: {random.randint(1, 100)}")
print(f"0-10之间的随机浮点数: {random.uniform(0, 10)}")

# 从序列中随机选择
colors = ["红", "绿", "蓝", "黄", "紫"]
print(f"随机颜色: {random.choice(colors)}")

# 随机抽样
sample_colors = random.sample(colors, 3)
print(f"随机抽取3种颜色: {sample_colors}")

# 打乱列表
numbers = list(range(1, 11))
print(f"原始列表: {numbers}")
random.shuffle(numbers)
print(f"打乱后: {numbers}")

# 设置随机种子（用于重现结果）
random.seed(42)
print(f"设置种子后的随机数: {random.randint(1, 100)}")

# 模拟掷骰子
def roll_dice():
    return random.randint(1, 6)

print("\n掷骰子5次:")
for i in range(5):
    print(f"第{i+1}次: {roll_dice()}")</code></pre>
                        </div>

                        <h3>os和pathlib - 文件系统操作</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 文件系统操作</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">import os
from pathlib import Path

# 获取当前目录信息
current_dir = os.getcwd()
print(f"当前工作目录: {current_dir}")

# 环境变量
home_dir = os.path.expanduser("~")
print(f"用户主目录: {home_dir}")

# 路径操作
file_path = os.path.join("folder", "subfolder", "file.txt")
print(f"构造的路径: {file_path}")

# 使用pathlib（推荐的现代方式）
current_path = Path.cwd()
print(f"当前路径（pathlib）: {current_path}")

# 路径组合和属性
demo_file = current_path / "demo.txt"
print(f"文件路径: {demo_file}")
print(f"文件名: {demo_file.name}")
print(f"父目录: {demo_file.parent}")
print(f"文件扩展名: {demo_file.suffix}")

# 检查路径
print(f"路径是否存在: {demo_file.exists()}")
print(f"是否为文件: {demo_file.is_file()}")
print(f"是否为目录: {demo_file.is_dir()}")

# 列出目录内容
print(f"\n当前目录的前5个项目:")
items = list(current_path.iterdir())[:5]
for item in items:
    item_type = "目录" if item.is_dir() else "文件"
    print(f"  {item.name} ({item_type})")</code></pre>
                        </div>
                    </section>

                    <!-- 知识点3：创建自定义模块 -->
                    <section class="mb-4">
                        <h2>🛠️ 创建自定义模块</h2>
                        <p>我们可以创建自己的模块来组织代码。下面演示如何创建和使用自定义模块。</p>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 模拟自定义模块</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 模拟创建一个数学工具模块的内容
# 在实际项目中，这些会放在单独的.py文件中

# ============ math_utils.py 模块内容 ============
def add(a, b):
    """加法函数"""
    return a + b

def multiply(a, b):
    """乘法函数"""
    return a * b

def factorial(n):
    """计算阶乘"""
    if n <= 1:
        return 1
    return n * factorial(n - 1)

def is_prime(n):
    """检查是否为质数"""
    if n < 2:
        return False
    for i in range(2, int(n ** 0.5) + 1):
        if n % i == 0:
            return False
    return True

# 模块级变量
PI = 3.14159
VERSION = "1.0.0"

# 模块初始化代码
print(f"数学工具模块 v{VERSION} 已加载")

# ============ 使用模块 ============
# 在实际使用中，你会这样导入：
# from math_utils import add, factorial, is_prime

# 测试模块功能
print(f"5 + 3 = {add(5, 3)}")
print(f"4 * 6 = {multiply(4, 6)}")
print(f"5! = {factorial(5)}")
print(f"17是质数吗？ {is_prime(17)}")
print(f"模块中的π值: {PI}")

# 批量测试质数
numbers = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
primes = [n for n in numbers if is_prime(n)]
print(f"1-11中的质数: {primes}")</code></pre>
                        </div>

                        <div class="alert alert-info">
                            <h6>📁 创建模块文件的步骤：</h6>
                            <ol>
                                <li>创建一个<code>.py</code>文件，如<code>math_utils.py</code></li>
                                <li>在文件中定义函数、类和变量</li>
                                <li>在其他文件中使用<code>import math_utils</code>导入</li>
                                <li>或使用<code>from math_utils import add, factorial</code>导入特定内容</li>
                            </ol>
                        </div>
                    </section>

                    <!-- 知识点4：包的概念 -->
                    <section class="mb-4">
                        <h2>📦 包的概念</h2>
                        <p>包是包含多个模块的目录。包使用<code>__init__.py</code>文件来标识。</p>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 包的结构示例</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python"># 包的目录结构示例：
# mypackage/
#     __init__.py
#     math_utils.py
#     string_utils.py
#     data/
#         __init__.py
#         processing.py

# 模拟包的导入和使用
print("包结构示例：")
print("""
mypackage/
├── __init__.py
├── math_utils.py
├── string_utils.py
└── data/
    ├── __init__.py
    └── processing.py
""")

# ============ mypackage/__init__.py ============
# 这个文件让Python知道这是一个包
# 可以在这里导入子模块，方便使用

__version__ = "1.0.0"
__author__ = "Your Name"

# 从子模块导入常用功能
# from .math_utils import add, multiply
# from .string_utils import capitalize_words

print(f"我的包已初始化，版本: {__version__}")

# ============ 模拟使用包 ============
# 实际使用方式：
# import mypackage
# from mypackage import math_utils
# from mypackage.data import processing

# 显示包的使用方式
print("\n包的导入方式：")
print("1. import mypackage")
print("2. from mypackage import math_utils")
print("3. from mypackage.math_utils import add")
print("4. from mypackage.data import processing")

# 模拟字符串工具模块
def capitalize_words(text):
    """将文本中每个单词的首字母大写"""
    return ' '.join(word.capitalize() for word in text.split())

def reverse_words(text):
    """反转文本中的单词顺序"""
    return ' '.join(text.split()[::-1])

# 测试字符串工具
test_text = "hello world python programming"
print(f"\n原文本: {test_text}")
print(f"首字母大写: {capitalize_words(test_text)}")
print(f"反转单词: {reverse_words(test_text)}")</code></pre>
                        </div>
                    </section>

                    <!-- 知识点5：模块搜索路径 -->
                    <section class="mb-4">
                        <h2>🔍 模块搜索路径</h2>
                        
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 模块搜索路径</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">import sys
import os

# 查看模块搜索路径
print("Python模块搜索路径：")
for i, path in enumerate(sys.path[:5], 1):  # 只显示前5个
    print(f"{i}. {path}")

if len(sys.path) > 5:
    print(f"... 还有 {len(sys.path) - 5} 个路径")

# 查看已加载的模块
loaded_modules = list(sys.modules.keys())
print(f"\n已加载的模块数量: {len(loaded_modules)}")
print("部分已加载的模块:")
for module in sorted(loaded_modules)[:10]:
    print(f"  {module}")

# 动态添加模块路径（演示用）
# 实际项目中需要谨慎使用
current_dir = os.getcwd()
if current_dir not in sys.path:
    print(f"\n当前目录已在搜索路径中")
else:
    print(f"\n当前目录不在搜索路径中")

# 查看内置模块
print(f"\n内置模块数量: {len(sys.builtin_module_names)}")
print("部分内置模块:")
for module in list(sys.builtin_module_names)[:10]:
    print(f"  {module}")

# 获取模块信息
import math
print(f"\nmath模块信息:")
print(f"  模块名: {math.__name__}")
print(f"  模块文件: {getattr(math, '__file__', '内置模块')}")

# dir()函数 - 查看模块的属性
math_attrs = [attr for attr in dir(math) if not attr.startswith('_')]
print(f"  math模块的部分功能: {math_attrs[:10]}")</code></pre>
                        </div>
                    </section>

                    <!-- 实践练习 -->
                    <section class="mb-4">
                        <h2>💻 实践练习</h2>
                        
                        <h3>练习1：时间工具模块</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 时间工具模块</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">import time
from datetime import datetime, timedelta

# 创建一个时间工具模块
class TimeUtils:
    """时间工具类"""
    
    @staticmethod
    def current_timestamp():
        """获取当前时间戳"""
        return time.time()
    
    @staticmethod
    def format_timestamp(timestamp, fmt="%Y-%m-%d %H:%M:%S"):
        """格式化时间戳"""
        return datetime.fromtimestamp(timestamp).strftime(fmt)
    
    @staticmethod
    def time_difference(start_time, end_time, unit="seconds"):
        """计算时间差"""
        diff = end_time - start_time
        
        if unit == "seconds":
            return diff
        elif unit == "minutes":
            return diff / 60
        elif unit == "hours":
            return diff / 3600
        elif unit == "days":
            return diff / 86400
        else:
            return diff
    
    @staticmethod
    def add_time(base_time, **kwargs):
        """给时间添加时间间隔"""
        if isinstance(base_time, str):
            base_time = datetime.strptime(base_time, "%Y-%m-%d %H:%M:%S")
        elif isinstance(base_time, (int, float)):
            base_time = datetime.fromtimestamp(base_time)
        
        return base_time + timedelta(**kwargs)
    
    @staticmethod
    def is_weekend(date_input):
        """检查是否为周末"""
        if isinstance(date_input, str):
            date_obj = datetime.strptime(date_input, "%Y-%m-%d")
        elif isinstance(date_input, datetime):
            date_obj = date_input
        else:
            return False
        
        return date_obj.weekday() >= 5  # 5是周六，6是周日

# 测试时间工具
print("时间工具测试：")

# 当前时间戳
current_ts = TimeUtils.current_timestamp()
print(f"当前时间戳: {current_ts}")

# 格式化时间戳
formatted = TimeUtils.format_timestamp(current_ts)
print(f"格式化时间: {formatted}")

# 计算时间差
start_time = current_ts - 3600  # 1小时前
time_diff = TimeUtils.time_difference(start_time, current_ts, "hours")
print(f"时间差: {time_diff:.2f}小时")

# 添加时间
future_time = TimeUtils.add_time(current_ts, days=7, hours=3)
print(f"7天3小时后: {future_time.strftime('%Y-%m-%d %H:%M:%S')}")

# 检查周末
test_dates = ["2023-12-23", "2023-12-24", "2023-12-25"]  # 周六、周日、周一
for date_str in test_dates:
    is_weekend = TimeUtils.is_weekend(date_str)
    weekday = datetime.strptime(date_str, "%Y-%m-%d").strftime("%A")
    print(f"{date_str} ({weekday}): {'是' if is_weekend else '不是'}周末")</code></pre>
                        </div>

                        <h3>练习2：文件处理模块</h3>
                        <div class="code-example">
                            <div class="code-header">
                                <span>💻 文件处理模块</span>
                                <button class="btn btn-sm btn-primary run-code">运行代码</button>
                            </div>
                            <pre><code class="language-python">import os
import json
from pathlib import Path

class FileUtils:
    """文件处理工具类"""
    
    @staticmethod
    def get_file_info(file_path):
        """获取文件信息"""
        path = Path(file_path)
        if not path.exists():
            return None
        
        stat = path.stat()
        return {
            "name": path.name,
            "size": stat.st_size,
            "created": stat.st_ctime,
            "modified": stat.st_mtime,
            "is_file": path.is_file(),
            "is_dir": path.is_dir(),
            "extension": path.suffix
        }
    
    @staticmethod
    def list_files(directory, pattern="*", recursive=False):
        """列出目录中的文件"""
        path = Path(directory)
        if not path.exists():
            return []
        
        if recursive:
            return list(path.rglob(pattern))
        else:
            return list(path.glob(pattern))
    
    @staticmethod
    def create_demo_files():
        """创建演示文件"""
        demo_data = {
            "students": [
                {"name": "张三", "age": 20, "score": 85},
                {"name": "李四", "age": 21, "score": 92},
                {"name": "王五", "age": 19, "score": 78}
            ],
            "timestamp": TimeUtils.current_timestamp()
        }
        return demo_data
    
    @staticmethod
    def safe_filename(filename):
        """创建安全的文件名"""
        # 移除或替换不安全的字符
        unsafe_chars = '<>:"/\\|?*'
        safe_name = filename
        for char in unsafe_chars:
            safe_name = safe_name.replace(char, '_')
        return safe_name
    
    @staticmethod
    def get_file_extension(filename):
        """获取文件扩展名"""
        return Path(filename).suffix.lower()
    
    @staticmethod
    def change_extension(filename, new_ext):
        """修改文件扩展名"""
        path = Path(filename)
        return str(path.with_suffix(new_ext))

# 测试文件工具
print("文件工具测试：")

# 创建演示数据
demo_data = FileUtils.create_demo_files()
print("演示数据:", demo_data)

# 测试安全文件名
unsafe_name = "我的文件<>?.txt"
safe_name = FileUtils.safe_filename(unsafe_name)
print(f"不安全的文件名: {unsafe_name}")
print(f"安全的文件名: {safe_name}")

# 测试文件扩展名
test_files = ["document.pdf", "image.PNG", "script.py", "data.json"]
for filename in test_files:
    ext = FileUtils.get_file_extension(filename)
    new_name = FileUtils.change_extension(filename, ".bak")
    print(f"{filename} -> 扩展名: {ext}, 备份名: {new_name}")

# 获取当前目录信息
current_dir = Path.cwd()
print(f"\n当前目录: {current_dir}")

# 演示文件操作（不实际创建文件）
print("\n文件操作演示（模拟）:")
demo_files = ["config.json", "data.csv", "report.pdf", "script.py"]
for filename in demo_files:
    print(f"  {filename} - 扩展名: {FileUtils.get_file_extension(filename)}")

print("\n模块学习总结:")
print("✓ 学会了导入和使用标准库模块")
print("✓ 掌握了创建自定义模块的方法")
print("✓ 理解了包的组织结构")
print("✓ 学会了模块搜索路径的概念")</code></pre>
                        </div>
                    </section>

                    <!-- 章节总结 -->
                    <section class="mb-4">
                        <div class="card bg-light">
                            <div class="card-header">
                                <h5>📋 本章总结</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>模块是组织Python代码的基本单位</li>
                                    <li>标准库提供了丰富的模块：math、datetime、random、os等</li>
                                    <li>可以创建自定义模块来重用代码</li>
                                    <li>包是包含多个模块的目录结构</li>
                                    <li>理解模块搜索路径有助于解决导入问题</li>
                                    <li>良好的模块设计提高代码可维护性</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- 导航按钮 -->
                    <div class="d-flex justify-content-between mb-4">
                        <a href="chapter7.html" class="btn btn-outline-primary">← 上一章：函数</a>
                        <a href="chapter9.html" class="btn btn-primary">下一章：字符串处理 →</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 引入必要的JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script src="../assets/js/tutorial-interactive.js"></script>
</body>
</html>
